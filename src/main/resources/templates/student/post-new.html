<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Create a post</title>
    <style>
        body { font-family: system-ui, sans-serif; margin: 24px; }
        textarea { width: 100%; max-width: 800px; height: 180px; }
        .err { color: #b00020; }
    </style>
</head>
<body>
<h2>Create a post</h2>

<div th:if="${param.error}">
    <p class="err" th:text="${param.error}">Error</p>
</div>

<div th:if="${#lists.isEmpty(clubs)}">
    <p>You aren’t a member of any clubs yet.</p>
    <p><a th:href="@{/explore/clubs}">Explore clubs</a> and join one to start posting.</p>
</div>

<div th:if="${!#lists.isEmpty(clubs)}">
    <form th:action="@{/me/posts}" method="post">
        <label>Club</label>
        <select name="clubId" required>
            <option value="" th:if="${#lists.size(clubs) > 1}" disabled th:selected="${preselectClubId == null}">Select a club</option>
            <option th:each="c : ${clubs}" th:value="${c.id}"
                    th:text="${c.name + ' — ' + c.universityName}"
                    th:selected="${preselectClubId != null and preselectClubId == c.id}">
                Club
            </option>
        </select>

        <label style="display:block; margin-top:10px;">Content</label>
        <textarea name="content" placeholder="Share something with your club..." required></textarea>

        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <div style="margin-top:10px;">
            <button type="submit">Post</button>
            <a th:href="@{/student/feed}" style="margin-left:8px;">Cancel</a>
        </div>
    </form>
</div>
</body>
</html>